vizlab: "0.1.7"
info:
  id: internal-analytics
  name: Internal analytics reporting
  date: 2017-04-03
  publish-date: 2099-01-01
  path: /analytics
  analytics-id: UA-78530187-1
  description: >-
    Internal reporting project to look at analytics data across the portfolio.
  thumbnail:
    url:
    width: 250
    height: 250
    alttext:
  required-packages:
    vizlab:
      repo: github
      version: 0.1.7
      name: USGS-VIZLAB/vizlab
      ref: v0.1.7
    dplyr:
      repo: CRAN
      version: 0.5.0
    googleAnalyticsR:
      repo: CRAN
      version: 0.5.1
    data.table:
      repo: CRAN
      version: 1.10.4
    sbtools:
      repo: CRAN
      version: 1.1.6
    assertthat:
      repo: CRAN
      version: 0.2.0
      
fetch:
  -
    id: fetchGA_cida
    login: cida #only fetch CIDA acct views
    fetcher: GAviews
    scripts: scripts/fetch/fetchGA.R
    location: cache/fetch/gaData.csv
    mimetype: text/csv
    remoteFilename: 'gaData.csv'
    remoteItemId: '58e56f3ce4b09da679997f7f' #'hybrid' fetcher, will check SB first
    update: FALSE #check for newer data from GA, and upload to sciencebase if there is
    useLocal: TRUE #Don't even download sciencebase file - overrides update
    depends: 
      project_table: project_table
  -
    id: fetchGA_nwis
    login: nwis
    fetcher: GAviews
    scripts: scripts/fetch/fetchGA.R
    location: cache/fetch/gaData_nwis.csv
    mimetype: text/csv
    remoteItemId: '58e56f3ce4b09da679997f7f'
    update: FALSE
    useLocal: TRUE
    depends:
      project_table: project_table
  -
    id: project_table
    fetcher: file
    location: data/ga_table.csv
    scripts:
    mimetype: text/csv
  -
    id: siteText
    location: data/siteText.yaml
    scripts:
    reader: md
    mimetype: text/yaml
process:
  -
    id: aggregate_ga
    processor: aggregate_ga
    scripts: scripts/process/aggregate.R
    depends: [fetchGA_cida, fetchGA_nwis]
    mimetype: text/csv
    location: cache/process/aggregate_ga.csv
  -
    id: sessions_and_new_users
    processor: sessions_and_new_users 
    scripts: scripts/process/sessions_and_new_users.R
    depends: aggregate_ga
    reader: rds
    location: cache/process/sessions_and_new_users.rds
visualize:
  -
    id: viz_month_sessions
    visualizer: viz_month_sessions 
    scripts: scripts/visualize/viz_month_sessions.R
    depends: sessions_and_new_users
    mimetype: text/csv
    location: cache/visualize/viz_month_sessions.csv
  -
    id: viz_ymd_sessions
    visualizer: viz_ymd_sessions 
    scripts: scripts/visualize/visualize.viz_ymd_sessions.R
    depends: sessions_and_new_users
    mimetype: text/csv
    location: cache/visualize/viz_ymd_sessions.csv
publish:
  -
    id: openSans
    publisher: googlefont
    family: Open Sans
    weight: [300, 400, 600]
  -
    id: internalAnalyticsCSS
    location: layout/css/internalAnalytics.css
    mimetype: text/css
    publisher: resource
  -
    id: detailsCSS
    location: layout/css/details.css
    mimetype: text/css
    publisher: resource
  -
    id: arrow
    location: images/arrow.svg
    mimetype: image/svg
    inline: true
    title: "Toggle"
    alttext: "Toggle Arrow"
  -
    id: index
    name: index
    publisher: page
    template: fullpage
    depends:
      openSans: openSans
      header: header
      footer: footer
      frontPage: frontPage
      internalAnalyticsCSS: internalAnalyticsCSS
      detailsCSS: detailsCSS
      headerCSS: lib-header-css
      jquery: jquery-js
      appJS: app-js
    context:
      header: header
      footer: footer
      sections: ["frontPage"]
      resources: ["jquery", "appJS", "openSans", "headerCSS", "internalAnalyticsCSS", "detailsCSS"]
  -
    id: projectPages
    publisher: projectpage
    scripts: scripts/publish/projectpage.R
    template: layout/templates/details.mustache
    depends:
      header: header
      footer: footer
      internalAnalyticsCSS: internalAnalyticsCSS
      headerCSS: lib-header-css
      details: details
      project_table: project_table
      viz_month_sessions: viz_month_sessions
    context:
      header: header
      footer: footer
      sections: [ "details" ]
      resources: ["headerCSS", "internalAnalyticsCSS"]
  -
    id: header
    publisher: section
    template: header-template
    context:
      title: Water Analytics - Portfolio Daily Summary
  -
    id: frontPage
    template: layout/templates/frontPage.mustache
    publisher: section
    depends:
      arrow: arrow
      siteText: siteText
    context:
      arrow: arrow
      aboutThisReport: siteText.aboutThisReport
      disclaimerTitle: siteText.disclaimerTitle
      disclaimer1: siteText.disclaimer1
      disclaimer2: siteText.disclaimer2
      glossaryTitle: siteText.glossaryTitle
      session: siteText.session
      visitors: siteText.visitors
      geographical: siteText.geographical
      average: siteText.average
      traffic: siteText.traffic
      device: siteText.device
  -
    id: details
    template: layout/templates/details.mustache
    publisher: section
    depends:
      arrow: arrow
      siteText: siteText
    context:
      arrow: arrow
      aboutThisReport: siteText.aboutThisReport
      disclaimerTitle: siteText.disclaimerTitle
      disclaimer1: siteText.disclaimer1
      disclaimer2: siteText.disclaimer2
      glossaryTitle: siteText.glossaryTitle
      session: siteText.session
      visitors: siteText.visitors
      geographical: siteText.geographical
      average: siteText.average
      traffic: siteText.traffic
      device: siteText.device
  -
    id: footer
    publisher: section
    template: layout/templates/footer.mustache
  -
    id: jquery-js
    location: layout/js/jquery.min.js
    mimetype: text/javascript
  -
    id: app-js
    location: layout/js/app.js
    mimetype: text/javascript
    
